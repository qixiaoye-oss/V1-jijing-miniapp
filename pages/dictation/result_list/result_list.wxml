<import src="/templates/page-loading.wxml" />
<template is="pageLoading" data="{{loading, loadProgress}}" />
<skeleton type="list" loading="{{!_isDataReady}}" rows="{{5}}" />
<wxs src="/utils/util.wxs" module="wxsUtil" />
<view class="page-content" wx:if="{{_isDataReady}}">
  <view wx:for="{{list}}" wx:key="id" class="question-card {{item.status != 1 ? 'question-card--wrong' : (item.isMark ? 'question-card--marked' : '')}}">
    <!-- 标题行：序号 + 用户答案 + 状态 + 开关（禁用） -->
    <view class="question-header">
      <view class="question__no">{{index+1}}</view>
      <view class="question__title">{{wxsUtil.formatNull(item.userChoice, '未填写')}}</view>
      <view class="question__switch-group question__switch-group--disabled">
        <view class="question__status {{item.status == 1 && !item.isMark ? 'question__status--gray' : ''}}">{{item.status != 1 ? '自动标记' : (item.isMark ? '已标记' : '未标记')}}</view>
        <switch checked="{{item.status != 1 || item.isMark}}" disabled="{{true}}" color="{{item.status != 1 ? '#F92F60' : '#FFB02E'}}" style="zoom:.7;" />
      </view>
    </view>

    <!-- 单词区域 -->
    <view class="word-section">
      <view class="word-content">
        <view class="flex_row">
          <view class="word_text" wx:for="{{item.answerArr}}" wx:key="*this" wx:for-item="answer">{{answer}}</view>
        </view>
        <view class="word_translate">{{item.chinese}}</view>
      </view>
      <view class="play-btn">
        <tap-action icon="play">
          <image src="/images/v2/pause_bt.png" wx:if="{{item.wordPlay === 'play'}}"></image>
          <image src="/images/v2/play_bt.png" wx:else bindtap="playWordAudio" data-index="{{index}}"></image>
        </tap-action>
      </view>
    </view>

    <!-- 例句区域 -->
    <view class="sentence-section">
      <view class="sentence-content">
        <view class="sentence_text">{{item.content}}</view>
        <view class="sentence_translate">{{item.chineseTranslate}}</view>
      </view>
      <view class="play-btn">
        <tap-action icon="play">
          <image src="/images/v2/pause_bt.png" wx:if="{{item.sentencePlay === 'play'}}"></image>
          <image src="/images/v2/play_bt.png" wx:else bindtap="playSentenceAudio" data-index="{{index}}"></image>
        </tap-action>
      </view>
    </view>
  </view>
</view>
<view class="btn-page-bottom" wx:if="{{_isDataReady}}">
  <view class="btn-group-single">
    <tap-action icon="save" bind:tap="returnPage">
      <view>返回</view>
      <image src="/images/v2/save_bt.png"></image>
    </tap-action>
  </view>
</view>
